# 本申請に係る具体的な通信方式

Semtech社製LoRaモジュールを制御するソフトウェアを配布しております。
ソフトウェアの動作仕様・通信方式は下記URLで参照下さい。

1. LoRaKissTNC
https://github.com/w-ockham/LoRaKissTNC

1. プロトコル詳細説明　
https://github.com/w-ockham/LoRaKissTNC/blob/master/Protocol.md

# LoRaトランシーバの通信方式

## LoRa変調
チャープスペクトラム拡散方式により変調され変調時には以下のパラメータを用います。

| パラメータ | 値 |
|:---------:|:---:|
|プリアンブル長| 12シンボル（レジスタ値8) |
|ヘッダー| Explicit |
|SYNCワード|0x12 (PRIVATE) |
|帯域 | 7.8 - 20.8 kHz(デフォルト値15.6kHz) |
|拡散率| 6 - 12 (デフォルト値9) |
|コーディングレート| 5/8 |
|Payload CRC| 無し |

## LoRaパケットフォーマット
LoRaパケットフォーマットは以下の通りです。

| プリアンブル | SYNC | ヘッダ | ペイロード |
|:-----------:|:----:|:-----:|:---------:|
| 00(12シンボル分)| 0x12 |Explicitヘッダ| (下記) |

パケットはExplicitヘッダーモードで送信され、Explicitヘッダにはペイロード長、ペイロードのコーディングレート、
ペイロードのCRCの有無（本方式では無）が入ります。ヘッダー自身はコーディングレート 4/8でCRC付きで送信されます。
詳細については [Semtech SX1276/77/78/79](http://www.semtech.com/apps/product.php?pn=SX1276)データシートを参照して下さい。

### ペイロード
ペイロードには平文を送る「平文ペイロード」とAX.25に準拠したパケットフォーマットで送る「AX.25ペイロード」の2種類があります。

#### 平文ペイロード
LoRaトランシーバ局間で無手順でメッセージ交換を行う際に平文ペイロードを用います。平文ペイロードはユーザが入力する平文を以下の形式で送信します。

|コールサイン|デリミタ|メッセージ|
|:---------:|:-----:|:--------:|
|自局コールサイン| :> | メッセージ(任意長)|

自局コールサインはアプリケーションで指定するコールサインです。メッセージはUTF-8でエンコーディングされた平文テキストが入ります。
各局呼び出し時にはメッセージにCQの文字列を、相手局を指定した交信の場合には相手局コールサインを入力するなど運用規則に則り運用して下さい。

#### AX.25ペイロード
LoRaトランシーバを[APRS](http://www.aprs.org/doc/APRS101.PDF)のTNC（ターミナルノードコントローラ）として用いる場合AX.25ペイロードを用います。

ペイロードにはAPRSパケットが送出されます。[AX.25 Link Access Protocol for Amateur Packet Radio](https://www.tapr.org/pdf/AX25.2.2.pdf)に準拠した以下のフォーマットのペイロードになります。

|Flag| Destination Address | Source Address| Digipeater Addresses|Control Field|Protocol Field| Information Field|FCS|Flag|
|:--:|:-------------------:|:-------------:|:-------------------:|:-----------:|:------------:|:----------------:|:-:|:--:|
| 0x7e | 相手局AX.25コールサイン | 自局AX.25コールサイン| APRSデジピートアドレス| 0x03 | 0xf0 |任意長データ | フレームチェックシーケンス(2byte)|0x7e|

APRSの詳細については[APRS PROTOCOL REFERENCE Protocol Version1.0](http://www.aprs.org/doc/APRS101.PDF)及び[APRS SPEC Addendum 1.1](http://www.aprs.org/aprs11.html)を参照ください。
